:root {
  /* Magia Responsiva:
     El tamaño ideal de la celda es 2.2% del ancho de la pantalla (2.2vw).
     Pero nunca bajará de 20px (para móviles/laptops chicas) ni pasará de 40px (pantallas gigantes).
  */
  --cell-size: clamp(20px, 2.2vw, 40px); 
  
  --border-color: #ffffff;
  --bg-excel: #f0f2f5;
  --color-libre: #00ff00;
  --color-ocupado: #ff0000;
  --color-azul: #cfe2f3; 
  --text-color: #000;
}

/* Modificamos el padding fijo por uno dinámico */
.contenedor-principal {
  padding: calc(var(--cell-size) * 1);
  background-color: white;
  min-height: 100vh;
  font-family: Arial, Helvetica, sans-serif;
  display: flex;
  justify-content: center;
  overflow-x: auto;
}

.layout-macro {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  /* Cambiamos el gap de 40px a 1.2 veces el tamaño de una celda */
  gap: calc(var(--cell-size) * 1.2); 
}

.flex-col { display: flex; flex-direction: column; }
.flex-row { display: flex; flex-direction: row; }

.celda {
  width: var(--cell-size);
  height: var(--cell-size);
  display: flex;
  align-items: center;
  justify-content: center;
  /* La fuente también se achica con la celda */
  font-size: calc(var(--cell-size) * 0.35); 
  font-weight: bold;
  border: 1px solid var(--border-color);
  color: var(--text-color);
  cursor: pointer;
  box-sizing: border-box;
}

.libre { background-color: var(--color-libre); }
.ocupado { background-color: var(--color-ocupado); color: white; }
.azul { 
  background-color: var(--color-azul); 
  border: 1px solid white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: calc(var(--cell-size) * 0.4);
  text-align: center;
}

.texto-vertical {
  writing-mode: vertical-rl;
  transform: rotate(180deg);
}

.panel-info {
  background-color: #e6eff6;
  border: 1px solid white;
  padding: calc(var(--cell-size) * 0.6);
  /* Ancho amarrado a 11 celdas de ancho */
  width: calc(var(--cell-size) * 11); 
  /* Márgenes amarrados al tamaño de la celda */
  margin: 0 calc(var(--cell-size) * 0.8); 
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.panel-info h3 { 
    margin-top: 0; 
    font-size: calc(var(--cell-size) * 0.45); 
    text-decoration: underline; 
    margin-bottom: calc(var(--cell-size) * 0.4);
}
.dato-fila { display: flex; margin-bottom: 8px; font-size: calc(var(--cell-size) * 0.4); }
.dato-label { font-weight: bold; width: calc(var(--cell-size) * 2.5); }
.dato-valor { color: #2c5282; font-weight: bold; }

.par-doble {
  display: flex;
  flex-direction: column;
}

.tooltip-flotante {
  position: fixed; 
  background-color: rgba(26, 32, 44, 0.95);
  color: white;
  padding: 12px 15px;
  border-radius: 8px;
  font-size: 13px;
  pointer-events: none; 
  z-index: 9999; 
  box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5); 
  border: 1px solid rgba(255, 255, 255, 0.1);
  min-width: 150px;
  backdrop-filter: blur(4px); 
}

.tooltip-header {
  border-bottom: 1px solid #4a5568;
  padding-bottom: 5px;
  margin-bottom: 5px;
  font-weight: bold;
  color: #63b3ed; /* Azul claro para el título */
  font-size: 11px;
  text-transform: uppercase;
}

.tooltip-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 3px;
}

.tooltip-label { color: #a0aec0; font-size: 11px; margin-right: 10px;}
.tooltip-value { font-weight: bold; text-align: right;}